{
  "permissions": {
    "allow": [
      "WebSearch",
      "mcp__context7__resolve-library-id",
      "mcp__context7__query-docs",
      "Bash(uv sync:*)",
      "Bash(/Users/juho/Projects/sote-bote/static/app.ts << 'EOF'\ninterface SummaryData {\n  summary: string;\n  key_points: string[];\n  language: string;\n}\n\nconst STORAGE_KEY = \"sote_bote_summary\";\n\nfunction saveSummaryToStorage\\(data: SummaryData\\): void {\n  try {\n    console.log\\(\"üíæ Saving to localStorage:\", data\\);\n    localStorage.setItem\\(STORAGE_KEY, JSON.stringify\\(data\\)\\);\n    console.log\\(\"‚úÖ Saved successfully to localStorage\"\\);\n  } catch \\(error\\) {\n    console.error\\(\"‚ùå Failed to save to localStorage:\", error\\);\n  }\n}\n\nfunction loadSummaryFromStorage\\(\\): SummaryData | null {\n  try {\n    const stored = localStorage.getItem\\(STORAGE_KEY\\);\n    console.log\\(\"üìÇ Loading from localStorage:\", stored\\);\n    const parsed = stored ? JSON.parse\\(stored\\) : null;\n    console.log\\(\"üì¶ Parsed data:\", parsed\\);\n    return parsed;\n  } catch \\(error\\) {\n    console.error\\(\"‚ùå Failed to load from localStorage:\", error\\);\n    return null;\n  }\n}\n\nfunction displaySummary\\(data: SummaryData\\): void {\n  console.log\\(\"üé® Displaying summary:\", data\\);\n  clearPlaceholder\\(\\);\n  document.getElementById\\(\"summary\"\\)!.textContent = data.summary;\n\n  const keypointsDiv = document.getElementById\\(\"keypoints\"\\)!;\n  if \\(data.key_points && data.key_points.length > 0\\) {\n    const ol = document.createElement\\(\"ol\"\\);\n    data.key_points.forEach\\(\\(point\\) => {\n      const li = document.createElement\\(\"li\"\\);\n      li.textContent = point;\n      ol.appendChild\\(li\\);\n    }\\);\n    keypointsDiv.innerHTML = \"<h4>Key Points:</h4>\";\n    keypointsDiv.appendChild\\(ol\\);\n  } else {\n    keypointsDiv.innerHTML = \"\";\n  }\n\n  // Save to localStorage as fallback\n  saveSummaryToStorage\\(data\\);\n}\n\nfunction showError\\(message: string\\): void {\n  document.getElementById\\(\"error-message\"\\)!.textContent = message;\n  document.getElementById\\(\"error-box\"\\)!.style.display = \"block\";\n  const summaryEl = document.getElementById\\(\"summary\"\\)!;\n  summaryEl.className = \"\";\n  summaryEl.textContent = \"\";\n  document.getElementById\\(\"keypoints\"\\)!.innerHTML = \"\";\n}\n\nfunction hideError\\(\\): void {\n  document.getElementById\\(\"error-box\"\\)!.style.display = \"none\";\n}\n\nfunction showPlaceholder\\(\\): void {\n  console.log\\(\"üìù Showing placeholder\"\\);\n  const summaryEl = document.getElementById\\(\"summary\"\\)!;\n  summaryEl.textContent =\n    'No summary yet. Paste your transcript above and click \"Summarize\" to get started.';\n  summaryEl.className = \"placeholder\";\n}\n\nfunction clearPlaceholder\\(\\): void {\n  const summaryEl = document.getElementById\\(\"summary\"\\)!;\n  summaryEl.className = \"\";\n}\n\nfunction showLoading\\(\\): void {\n  const summaryEl = document.getElementById\\(\"summary\"\\)!;\n  summaryEl.className = \"\";\n  summaryEl.innerHTML =\n    '<div class=\"loading\"><div class=\"spinner\"></div><span>Summarizing your transcript...</span></div>';\n}\n\n// Load existing summary on page load\nwindow.onload = async function \\(\\): Promise<void> {\n  console.log\\(\"üöÄ Page loaded, attempting to load summary...\"\\);\n  debugger;\n\n  try {\n    console.log\\(\"üì° Fetching from /summary endpoint...\"\\);\n    const response = await fetch\\(\"/summary\", {\n      credentials: \"same-origin\",\n    }\\);\n    console.log\\(\"üì® Response received:\", response.status, response.statusText\\);\n\n    const data: SummaryData = await response.json\\(\\);\n    console.log\\(\"üìã Data from server:\", data\\);\n    debugger;\n\n    if \\(data.summary\\) {\n      console.log\\(\"‚úÖ Server has summary, displaying it\"\\);\n      displaySummary\\(data\\);\n      \\(document.getElementById\\(\"language\"\\) as HTMLSelectElement\\).value =\n        data.language;\n    } else {\n      console.log\\(\"‚ö†Ô∏è No summary from server, trying localStorage fallback...\"\\);\n      // Fallback to localStorage\n      const cachedData = loadSummaryFromStorage\\(\\);\n      if \\(cachedData && cachedData.summary\\) {\n        console.log\\(\"‚úÖ Found in localStorage, displaying it\"\\);\n        displaySummary\\(cachedData\\);\n        \\(document.getElementById\\(\"language\"\\) as HTMLSelectElement\\).value =\n          cachedData.language;\n      } else {\n        console.log\\(\"‚ùå No cached data, showing placeholder\"\\);\n        showPlaceholder\\(\\);\n      }\n    }\n  } catch \\(error\\) {\n    console.error\\(\"‚ùå Error loading summary:\", error\\);\n    debugger;\n\n    // Fallback to localStorage on error\n    console.log\\(\"üîÑ Trying localStorage fallback after error...\"\\);\n    const cachedData = loadSummaryFromStorage\\(\\);\n    if \\(cachedData && cachedData.summary\\) {\n      console.log\\(\"‚úÖ Found in localStorage, displaying it\"\\);\n      displaySummary\\(cachedData\\);\n      \\(document.getElementById\\(\"language\"\\) as HTMLSelectElement\\).value =\n        cachedData.language;\n    } else {\n      console.log\\(\"‚ùå No cached data, showing placeholder\"\\);\n      showPlaceholder\\(\\);\n    }\n  }\n};\n\nasync function summarize\\(\\): Promise<void> {\n  const text = \\(document.getElementById\\(\"transcript\"\\) as HTMLTextAreaElement\\)\n    .value;\n  const language = \\(document.getElementById\\(\"language\"\\) as HTMLSelectElement\\)\n    .value;\n\n  console.log\\(\"üîç Summarize called with:\", { text: text.substring\\(0, 50\\) + \"...\", language }\\);\n\n  if \\(!text.trim\\(\\)\\) {\n    showError\\(\"Please enter some text to summarize\"\\);\n    return;\n  }\n\n  hideError\\(\\);\n  showLoading\\(\\);\n  document.getElementById\\(\"keypoints\"\\)!.innerHTML = \"\";\n\n  try {\n    console.log\\(\"üì§ Sending POST to /summarize...\"\\);\n    const response = await fetch\\(\"/summarize\", {\n      method: \"POST\",\n      credentials: \"same-origin\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify\\({\n        text: text,\n        language: language,\n      }\\),\n    }\\);\n\n    console.log\\(\"üì® Summarize response:\", response.status, response.statusText\\);\n    const data: SummaryData = await response.json\\(\\);\n    console.log\\(\"üìã Summarize data:\", data\\);\n    debugger;\n\n    if \\(!response.ok\\) {\n      showError\\(\\(data as any\\).detail || \"Failed to summarize the text\"\\);\n      return;\n    }\n\n    console.log\\(\"‚úÖ Summarization successful, displaying result\"\\);\n    displaySummary\\(data\\);\n  } catch \\(error\\) {\n    console.error\\(\"‚ùå Summarization error:\", error\\);\n    debugger;\n    showError\\(\"Network error: \" + \\(error as Error\\).message\\);\n  }\n}\n\n\\(window as any\\).summarize = summarize;\nEOF)",
      "Bash(/Users/juho/Projects/sote-bote/static/app.ts << 'EOF'\ninterface SummaryData {\n  summary: string;\n  key_points: string[];\n  language: string;\n}\n\nconst STORAGE_KEY = \"sote_bote_summary\";\n\nfunction saveSummaryToStorage\\(data: SummaryData\\): void {\n  try {\n    localStorage.setItem\\(STORAGE_KEY, JSON.stringify\\(data\\)\\);\n  } catch \\(error\\) {\n    console.error\\(\"Failed to save to localStorage:\", error\\);\n  }\n}\n\nfunction loadSummaryFromStorage\\(\\): SummaryData | null {\n  try {\n    const stored = localStorage.getItem\\(STORAGE_KEY\\);\n    return stored ? JSON.parse\\(stored\\) : null;\n  } catch \\(error\\) {\n    console.error\\(\"Failed to load from localStorage:\", error\\);\n    return null;\n  }\n}\n\nfunction displaySummary\\(data: SummaryData\\): void {\n  clearPlaceholder\\(\\);\n  document.getElementById\\(\"summary\"\\)!.textContent = data.summary;\n\n  const keypointsDiv = document.getElementById\\(\"keypoints\"\\)!;\n  if \\(data.key_points && data.key_points.length > 0\\) {\n    const ol = document.createElement\\(\"ol\"\\);\n    data.key_points.forEach\\(\\(point\\) => {\n      const li = document.createElement\\(\"li\"\\);\n      li.textContent = point;\n      ol.appendChild\\(li\\);\n    }\\);\n    keypointsDiv.innerHTML = \"<h4>Key Points:</h4>\";\n    keypointsDiv.appendChild\\(ol\\);\n  } else {\n    keypointsDiv.innerHTML = \"\";\n  }\n\n  saveSummaryToStorage\\(data\\);\n}\n\nfunction showError\\(message: string\\): void {\n  document.getElementById\\(\"error-message\"\\)!.textContent = message;\n  document.getElementById\\(\"error-box\"\\)!.style.display = \"block\";\n  const summaryEl = document.getElementById\\(\"summary\"\\)!;\n  summaryEl.className = \"\";\n  summaryEl.textContent = \"\";\n  document.getElementById\\(\"keypoints\"\\)!.innerHTML = \"\";\n}\n\nfunction hideError\\(\\): void {\n  document.getElementById\\(\"error-box\"\\)!.style.display = \"none\";\n}\n\nfunction showPlaceholder\\(\\): void {\n  const summaryEl = document.getElementById\\(\"summary\"\\)!;\n  summaryEl.textContent =\n    'No summary yet. Paste your transcript above and click \"Summarize\" to get started.';\n  summaryEl.className = \"placeholder\";\n}\n\nfunction clearPlaceholder\\(\\): void {\n  const summaryEl = document.getElementById\\(\"summary\"\\)!;\n  summaryEl.className = \"\";\n}\n\nfunction showLoading\\(\\): void {\n  const summaryEl = document.getElementById\\(\"summary\"\\)!;\n  summaryEl.className = \"\";\n  summaryEl.innerHTML =\n    '<div class=\"loading\"><div class=\"spinner\"></div><span>Summarizing your transcript...</span></div>';\n}\n\nasync function loadExistingSummary\\(\\): Promise<void> {\n  try {\n    const response = await fetch\\(\"/summary\", {\n      credentials: \"same-origin\",\n    }\\);\n\n    const data: SummaryData = await response.json\\(\\);\n\n    if \\(data.summary\\) {\n      displaySummary\\(data\\);\n      \\(document.getElementById\\(\"language\"\\) as HTMLSelectElement\\).value =\n        data.language;\n    } else {\n      const cachedData = loadSummaryFromStorage\\(\\);\n      if \\(cachedData && cachedData.summary\\) {\n        displaySummary\\(cachedData\\);\n        \\(document.getElementById\\(\"language\"\\) as HTMLSelectElement\\).value =\n          cachedData.language;\n      } else {\n        showPlaceholder\\(\\);\n      }\n    }\n  } catch \\(error\\) {\n    console.error\\(\"Error loading summary:\", error\\);\n    const cachedData = loadSummaryFromStorage\\(\\);\n    if \\(cachedData && cachedData.summary\\) {\n      displaySummary\\(cachedData\\);\n      \\(document.getElementById\\(\"language\"\\) as HTMLSelectElement\\).value =\n        cachedData.language;\n    } else {\n      showPlaceholder\\(\\);\n    }\n  }\n}\n\nloadExistingSummary\\(\\);\n\nasync function summarize\\(\\): Promise<void> {\n  const text = \\(document.getElementById\\(\"transcript\"\\) as HTMLTextAreaElement\\)\n    .value;\n  const language = \\(document.getElementById\\(\"language\"\\) as HTMLSelectElement\\)\n    .value;\n\n  if \\(!text.trim\\(\\)\\) {\n    showError\\(\"Please enter some text to summarize\"\\);\n    return;\n  }\n\n  hideError\\(\\);\n  showLoading\\(\\);\n  document.getElementById\\(\"keypoints\"\\)!.innerHTML = \"\";\n\n  try {\n    const response = await fetch\\(\"/summarize\", {\n      method: \"POST\",\n      credentials: \"same-origin\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify\\({\n        text: text,\n        language: language,\n      }\\),\n    }\\);\n\n    const data: SummaryData = await response.json\\(\\);\n\n    if \\(!response.ok\\) {\n      showError\\(\\(data as any\\).detail || \"Failed to summarize the text\"\\);\n      return;\n    }\n\n    displaySummary\\(data\\);\n  } catch \\(error\\) {\n    console.error\\(\"Summarization error:\", error\\);\n    showError\\(\"Network error: \" + \\(error as Error\\).message\\);\n  }\n}\n\n\\(window as any\\).summarize = summarize;\nEOF)",
      "Bash(uv run pytest:*)",
      "Bash(uv run python:*)"
    ]
  }
}
